<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Operators | Cedar Policy Language Version 2.3 Reference Guide</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="Operators" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/syntax-operators.html" /> <meta property="og:url" content="http://localhost:4000/syntax-operators.html" /> <meta property="og:site_name" content="Cedar Policy Language Version 2.3 Reference Guide" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Operators" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Operators","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/images/Cedar1-green.png"}},"url":"http://localhost:4000/syntax-operators.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Cedar Policy Language Version 2.3 Reference Guide"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Table of contents</a></li><li class="nav-list-item"><a href="/what-is-cedar.html" class="nav-list-link">What is Cedar?</a></li><li class="nav-list-item"><a href="/terminology.html" class="nav-list-link">Terms & concepts</a></li><li class="nav-list-item"><a href="/scenario.html" class="nav-list-link">Example scenario</a></li><li class="nav-list-item"><a href="/authorization.html" class="nav-list-link">Authorization</a></li><li class="nav-list-item"><a href="/validation.html" class="nav-list-link">Policy validation</a></li><li class="nav-list-item"><a href="/schema.html" class="nav-list-link">Schema format</a></li><li class="nav-list-item"><a href="/templates.html" class="nav-list-link">Policy templates</a></li><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in Policy syntax category" aria-pressed="true"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/syntax.html" class="nav-list-link">Policy syntax</a><ul class="nav-list"><li class="nav-list-item "><a href="/syntax-policy.html" class="nav-list-link">Basic syntax</a></li><li class="nav-list-item "><a href="/syntax-entity.html" class="nav-list-link">Entity</a></li><li class="nav-list-item "><a href="/syntax-datatypes.html" class="nav-list-link">Data types</a></li><li class="nav-list-item active"><a href="/syntax-operators.html" class="nav-list-link active">Operators</a></li><li class="nav-list-item "><a href="/syntax-grammar.html" class="nav-list-link">Grammar</a></li></ul></li><li class="nav-list-item"><a href="/security.html" class="nav-list-link">Security</a></li><li class="nav-list-item"><a href="/doc-history.html" class="nav-list-link">Document history</a></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li></ul> </nav> <p>We welcome your feedback about these docs!<br> <a href="mailto:cedar-docs@amazon.com?subject=Feedback&body=My%20name%20%28optional%29:%0D%0A%0D%0AMy%20email%20%28optional%29:%0D%0A%0D%0AWhat%20I%20was%20trying%20to%20do:%0D%0A%0D%0AWhat%20to%20make%20better:">Send feedback by email</a> or use <a href="https://github.com/cedar-policy/cedar-docs/issues">GitHub Issues</a></p> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Cedar Policy Language Version 2.3 Reference Guide" aria-label="Search Cedar Policy Language Version 2.3 Reference Guide" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/syntax.html">Policy syntax</a></li> <li class="breadcrumb-nav-list-item"><span>Operators</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 class="no_toc" id="operators-and-functions-to-use-in-cedar"> <a href="#operators-and-functions-to-use-in-cedar" class="anchor-heading" aria-labelledby="operators-and-functions-to-use-in-cedar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Operators and functions to use in Cedar<a name="syntax-operators"></a> </h1> <p>This topic describes the built-in operators and functions that you can use to build your expressions using the Cedar policy language.</p> <details open=""> <summary class="text-delta"> Topics on this page </summary> <ul id="markdown-toc"> <li><a href="#overview-of-operators" id="markdown-toc-overview-of-operators">Overview of operators<a name="operators-overview"></a></a></li> <li><a href="#string-operators-and-functions" id="markdown-toc-string-operators-and-functions">String operators and functions<a name="operators-string"></a></a> <ul> <li><a href="#like-string-matching-with-wildcard" id="markdown-toc-like-string-matching-with-wildcard"><code class="language-plaintext highlighter-rouge">like</code> (string matching with wildcard)<a name="operators-string-like"></a></a> <ul> <li><a href="#more-examples" id="markdown-toc-more-examples">More Examples:</a></li> </ul> </li> <li><a href="#decimal-parse-string-and-convert-to-decimal" id="markdown-toc-decimal-parse-string-and-convert-to-decimal"><code class="language-plaintext highlighter-rouge">decimal()</code> (parse string and convert to decimal)<a name="function-decimal"></a></a> <ul> <li><a href="#examples" id="markdown-toc-examples">Examples:</a></li> </ul> </li> <li><a href="#ip-parse-string-and-convert-to-ipaddr" id="markdown-toc-ip-parse-string-and-convert-to-ipaddr"><code class="language-plaintext highlighter-rouge">ip()</code> (parse string and convert to ipaddr)<a name="function-ip"></a></a></li> </ul> </li> <li><a href="#comparison-operators-and-functions" id="markdown-toc-comparison-operators-and-functions">Comparison operators and functions<a name="operators-comparison"></a></a> <ul> <li><a href="#-equality" id="markdown-toc--equality"><code class="language-plaintext highlighter-rouge">==</code> (equality)<a name="operator-equality"></a></a> <ul> <li><a href="#examples-1" id="markdown-toc-examples-1">Examples:</a></li> </ul> </li> <li><a href="#-inequality" id="markdown-toc--inequality"><code class="language-plaintext highlighter-rouge">!=</code> (inequality)<a name="operator-inequality"></a></a> <ul> <li><a href="#example" id="markdown-toc-example">Example:</a></li> </ul> </li> <li><a href="#-long-integer-less-than" id="markdown-toc--long-integer-less-than"><code class="language-plaintext highlighter-rouge">&lt;</code> (long integer ‘less than’)<a name="operator-lessthan"></a></a> <ul> <li><a href="#examples-2" id="markdown-toc-examples-2">Examples:</a></li> </ul> </li> <li><a href="#lessthan-decimal-less-than" id="markdown-toc-lessthan-decimal-less-than"><code class="language-plaintext highlighter-rouge">.lessThan()</code> (decimal ‘less than’)<a name="function-lessThan"></a></a> <ul> <li><a href="#examples-3" id="markdown-toc-examples-3">Examples:</a></li> </ul> </li> <li><a href="#-long-integer-less-than-or-equal" id="markdown-toc--long-integer-less-than-or-equal"><code class="language-plaintext highlighter-rouge">&lt;=</code> (long integer ‘less than or equal’)<a name="operator-lessthanorequal"></a></a> <ul> <li><a href="#examples-4" id="markdown-toc-examples-4">Examples:</a></li> </ul> </li> <li><a href="#lessthanorequal-decimal-less-than-or-equal" id="markdown-toc-lessthanorequal-decimal-less-than-or-equal"><code class="language-plaintext highlighter-rouge">.lessThanOrEqual()</code> (decimal ‘less than or equal’)<a name="function-lessThanOrEqual"></a></a> <ul> <li><a href="#examples-5" id="markdown-toc-examples-5">Examples:</a></li> </ul> </li> <li><a href="#-long-integer-greater-than" id="markdown-toc--long-integer-greater-than"><code class="language-plaintext highlighter-rouge">&gt;</code> (long integer ‘greater than’)<a name="operator-greaterthan"></a></a> <ul> <li><a href="#examples-6" id="markdown-toc-examples-6">Examples:</a></li> </ul> </li> <li><a href="#greaterthan-decimal-greater-than-or-equal" id="markdown-toc-greaterthan-decimal-greater-than-or-equal"><code class="language-plaintext highlighter-rouge">.greaterThan()</code> (decimal ‘greater than or equal’)<a name="function-greaterThan"></a></a> <ul> <li><a href="#examples-7" id="markdown-toc-examples-7">Examples:</a></li> </ul> </li> <li><a href="#-long-integer-greater-than-or-equals" id="markdown-toc--long-integer-greater-than-or-equals"><code class="language-plaintext highlighter-rouge">&gt;=</code> (Long integer ‘greater than or equals’)<a name="operator-greaterthanorequal"></a></a> <ul> <li><a href="#examples-8" id="markdown-toc-examples-8">Examples:</a></li> </ul> </li> <li><a href="#greaterthanorequal-decimal-greater-than-or-equal" id="markdown-toc-greaterthanorequal-decimal-greater-than-or-equal"><code class="language-plaintext highlighter-rouge">.greaterThanOrEqual()</code> (decimal ‘greater than or equal’)<a name="function-greaterThanOrEqual"></a></a> <ul> <li><a href="#examples-9" id="markdown-toc-examples-9">Examples:</a></li> </ul> </li> </ul> </li> <li><a href="#logical-operators" id="markdown-toc-logical-operators">Logical operators<a name="operators-logical"></a></a> <ul> <li><a href="#-and" id="markdown-toc--and"><code class="language-plaintext highlighter-rouge">&amp;&amp;</code> (AND)<a name="operator-and"></a></a> <ul> <li><a href="#more-examples-1" id="markdown-toc-more-examples-1">More Examples:</a></li> </ul> </li> <li><a href="#-or" id="markdown-toc--or"><code class="language-plaintext highlighter-rouge">||</code> (OR)<a name="operator-or"></a></a> <ul> <li><a href="#more-examples-2" id="markdown-toc-more-examples-2">More Examples:</a></li> </ul> </li> <li><a href="#-not" id="markdown-toc--not"><code class="language-plaintext highlighter-rouge">!</code> (NOT)<a name="operator-not"></a></a> <ul> <li><a href="#example-1" id="markdown-toc-example-1">Example:</a></li> <li><a href="#more-examples-3" id="markdown-toc-more-examples-3">More Examples:</a></li> </ul> </li> </ul> </li> <li><a href="#arithmetic-operators" id="markdown-toc-arithmetic-operators">Arithmetic operators<a name="operators-math"></a></a> <ul> <li><a href="#-numeric-addition" id="markdown-toc--numeric-addition"><code class="language-plaintext highlighter-rouge">+</code> (Numeric addition)<a name="operator-add"></a></a> <ul> <li><a href="#example-2" id="markdown-toc-example-2">Example:</a></li> <li><a href="#other-examples" id="markdown-toc-other-examples">Other examples:</a></li> </ul> </li> <li><a href="#--numeric-subtraction-or-negation" id="markdown-toc---numeric-subtraction-or-negation"><code class="language-plaintext highlighter-rouge">-</code> (Numeric subtraction or negation)<a name="operator-subtract"></a></a> <ul> <li><a href="#examples-10" id="markdown-toc-examples-10">Examples:</a></li> <li><a href="#examples-11" id="markdown-toc-examples-11">Examples:</a></li> </ul> </li> <li><a href="#-numeric-multiplication" id="markdown-toc--numeric-multiplication"><code class="language-plaintext highlighter-rouge">*</code> (Numeric multiplication)<a name="operator-multiply"></a></a> <ul> <li><a href="#examples-12" id="markdown-toc-examples-12">Examples:</a></li> </ul> </li> </ul> </li> <li><a href="#hierarchy-and-set-membership-operators-and-functions" id="markdown-toc-hierarchy-and-set-membership-operators-and-functions">Hierarchy and set membership operators and functions<a name="functions-set"></a></a> <ul> <li><a href="#in-hierarchy-membership" id="markdown-toc-in-hierarchy-membership"><code class="language-plaintext highlighter-rouge">in</code> (Hierarchy membership)<a name="operator-in"></a></a> <ul> <li><a href="#examples-13" id="markdown-toc-examples-13">Examples:</a></li> <li><a href="#more-examples-4" id="markdown-toc-more-examples-4">More examples:</a></li> <li><a href="#more-examples-5" id="markdown-toc-more-examples-5">More Examples:</a></li> </ul> </li> <li><a href="#has-presence-of-attribute-test" id="markdown-toc-has-presence-of-attribute-test"><code class="language-plaintext highlighter-rouge">has</code> (presence of attribute test)<a name="operator-has"></a></a></li> <li><a href="#contains-single-element-set-membership-test" id="markdown-toc-contains-single-element-set-membership-test"><code class="language-plaintext highlighter-rouge">.contains()</code> (single element set membership test)<a name="function-contains"></a></a> <ul> <li><a href="#examples-14" id="markdown-toc-examples-14">Examples:</a></li> </ul> </li> <li><a href="#containsall-all-element-set-membership-test" id="markdown-toc-containsall-all-element-set-membership-test"><code class="language-plaintext highlighter-rouge">.containsAll()</code> (all element set membership test)<a name="function-containsAll"></a></a></li> <li><a href="#containsany-any-element-set-membership-test" id="markdown-toc-containsany-any-element-set-membership-test"><code class="language-plaintext highlighter-rouge">.containsAny()</code> (any element set membership test)<a name="function-containsAny"></a></a></li> </ul> </li> <li><a href="#ip-address-functions" id="markdown-toc-ip-address-functions">IP address functions<a name="functions-ipaddr"></a></a> <ul> <li><a href="#isipv4-ipv4-address-valid-test" id="markdown-toc-isipv4-ipv4-address-valid-test"><code class="language-plaintext highlighter-rouge">.isIpv4()</code> (IPv4 address valid test)<a name="function-isIpv4"></a></a></li> <li><a href="#isipv6-ipv6-address-valid-test" id="markdown-toc-isipv6-ipv6-address-valid-test"><code class="language-plaintext highlighter-rouge">.isIpv6()</code> (IPv6 address valid test)<a name="function-isIpv6.title"></a></a></li> <li><a href="#isloopback-test-for-ip-loopback-address" id="markdown-toc-isloopback-test-for-ip-loopback-address"><code class="language-plaintext highlighter-rouge">.isLoopback()</code> (test for IP loopback address)<a name="function-isLoopback.title"></a></a></li> <li><a href="#ismulticast-test-for-multicast-address" id="markdown-toc-ismulticast-test-for-multicast-address"><code class="language-plaintext highlighter-rouge">.isMulticast()</code> (test for multicast address)<a name="function-isMulticast.title"></a></a></li> <li><a href="#isinrange-test-for-inclusion-in-ip-address-range" id="markdown-toc-isinrange-test-for-inclusion-in-ip-address-range"><code class="language-plaintext highlighter-rouge">.isInRange()</code> (test for inclusion in IP address range)<a name="function-isInRange.title"></a></a></li> </ul> </li> </ul> </details> <h2 id="overview-of-operators"> <a href="#overview-of-operators" class="anchor-heading" aria-labelledby="overview-of-operators"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Overview of operators<a name="operators-overview"></a> </h2> <p>The operators use the following syntax structures:</p> <ul> <li> <p><strong>Unary operators</strong> – A unary operator takes one operand. Place the operand after the operator.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;operator&gt; operand
  
// Uses the logical NOT operator and evaluates to the 
// inverse of the value of the Boolean operand
! a
</code></pre></div> </div> </li> <li> <p><strong>Binary operators</strong> – A binary operator takes two operands. Place one operand before the operator and one after. Some binary operators are <a href="https://wikipedia.org/wiki/Commutative_property">commutative</a>. See the description of each operator to understand where operand order matters.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>firstOperand &lt;operator&gt; secondOperand
  
// Evaluates to true if both operands have the same type and value
a == b
  
// Evaluates to true if the first operand is within the 
// hierarchy of the second operand
c in d
</code></pre></div> </div> </li> </ul> <p>Functions use the following syntax:</p> <ul> <li> <p>Functions can support zero or more operands. Append the function name to the end of the entity name, separating them with a <code class="language-plaintext highlighter-rouge">.</code> (period) character. Place any operands in parentheses after the function name, separating them with commas.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>entity.function(firstOperand, secondOperand, …)
  
// Evaluates to true if the any of the set member 
// elements b, c, or d is an element of set a
a.containsAny([b, c, d])
</code></pre></div> </div> </li> </ul> <h2 id="string-operators-and-functions"> <a href="#string-operators-and-functions" class="anchor-heading" aria-labelledby="string-operators-and-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> String operators and functions<a name="operators-string"></a> </h2> <p>Use these operators and functions to compare strings or convert them to other types.</p> <h3 id="like-string-matching-with-wildcard"> <a href="#like-string-matching-with-wildcard" class="anchor-heading" aria-labelledby="like-string-matching-with-wildcard"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">like</code> (string matching with wildcard)<a name="operators-string-like"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;string&gt; like &lt;string with wildcards&gt;</code></p> <p>Binary operator that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the string in the left operand matches the pattern string in the right operand. The pattern string can include one or more asterisks (<code class="language-plaintext highlighter-rouge">*</code>) as wildcard characters that match 0 or more of any character.</p> <p>To match a literal asterisk character, use the escaped <code class="language-plaintext highlighter-rouge">\*</code> sequence in the pattern string.</p> <p>Consider a query with the following context:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"context": {
    "location": "s3://bucketA/redTeam/some/thing/*"
}
</code></pre></div></div> <p>In that scenario, the following expression returns <code class="language-plaintext highlighter-rouge">true</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context.location like "s 3:*"         //true
</code></pre></div></div> <h4 id="more-examples"> <a href="#more-examples" class="anchor-heading" aria-labelledby="more-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"eggs" like "ham*"                                             //false
"eggs" like "*ham"                                             //false
"eggs" like "*ham*"                                            //false
"ham and eggs" like "ham*"                                     //true
"ham and eggs" like "*ham"                                     //false
"ham and eggs" like "*ham*"                                    //true
"ham and eggs" like "*h*a*m*"                                  //true
"eggs and ham" like "ham*"                                     //false
"eggs and ham" like "*ham"                                     //true
"eggs, ham, and spinach" like "ham*"                           //false
"eggs, ham, and spinach" like "*ham"                           //false
"eggs, ham, and spinach" like "*ham*"                          //true
"Gotham" like "ham*"                                           //false
"Gotham" like "*ham"                                           //true
"ham" like "ham"                                               //true
"ham" like "ham*"                                              //true
"ham" like "*ham"                                              //true
"ham" like "*h*a*m*"                                           //true
"ham and ham" like "ham*"                                      //true
"ham and ham" like "*ham"                                      //true
"ham" like "*ham and eggs*"                                    //false
"\\afterslash" like "\\*"                                      //true
"string\\with\\backslashes" like "string\\with\\backslashes"   //true
"string\\with\\backslashes" like "string*with*backslashes"     //true
"string*with*stars" like "string\*with\*stars"                 //true
</code></pre></div></div> <h3 id="decimal-parse-string-and-convert-to-decimal"> <a href="#decimal-parse-string-and-convert-to-decimal" class="anchor-heading" aria-labelledby="decimal-parse-string-and-convert-to-decimal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">decimal()</code> (parse string and convert to decimal)<a name="function-decimal"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">decimal(&lt;string&gt;)</code></p> <p>Function that parses the string and tries to convert it to type <a href="/syntax-datatypes.html#datatype-decimal">decimal</a>. If the string doesn’t represent a valid decimal value, it generates an error.</p> <p>To be interpreted successfully as a decimal value, the string must contain a decimal separator (<code class="language-plaintext highlighter-rouge">.</code>) and at least one digit before and at least one digit after the separator. There can be no more than 4 digits after the separator. The value must be within the valid range of the decimal type, from <code class="language-plaintext highlighter-rouge">-922337203685477.5808</code> to <code class="language-plaintext highlighter-rouge">922337203685477.5807</code>.</p> <h4 id="examples"> <a href="#examples" class="anchor-heading" aria-labelledby="examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decimal("1.0")
decimal("-1.0")
decimal("123.456")
decimal("0.1234")
decimal("-0.0123")
decimal("55.1")
decimal("00.000")
decimal("1234")                  //error
decimal("1.0.")                  //error
decimal("1.")                    //error
decimal(".1")                    //error
decimal("1.a")                   //error
decimal("-.")                    //error
decimal("1000000000000000.0")    //overflow
decimal("922337203685477.5808")  //overflow
decimal("0.12345")               //error
decimal("0.00000")               //error
</code></pre></div></div> <h3 id="ip-parse-string-and-convert-to-ipaddr"> <a href="#ip-parse-string-and-convert-to-ipaddr" class="anchor-heading" aria-labelledby="ip-parse-string-and-convert-to-ipaddr"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">ip()</code> (parse string and convert to ipaddr)<a name="function-ip"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">ip(&lt;string&gt;)</code></p> <p>Function that parses the string and attempts to convert it to type <code class="language-plaintext highlighter-rouge">ipaddr</code>. If the string doesn’t represent a valid IP address or range, then it generates an error.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip("127.0.0.1")
ip("::1")
ip("127.0.0.1/24")
ip("ffee::/64")
ip("ff00::2")
ip("::2")

ip("380.0.0.1")                     //error – invalid IPv4 address
ip("ab.ab.ab.ab")                   //error – invalid IPv4 address
ip("127.0.0.1/8/24")                //error – invalid CIDR notation
ip("fee::/64::1")                   //error – invalid IPv6 address
ip("fzz::1")                        //error – invalid character in address
ip([127,0,0,1])                     //error – invalid type 
"127.0.0.1".ip()                    //error – invalid call style

ip("127.0.0.1") == ip("127.0.0.1")            //true
ip("192.168.0.1") == ip("8.8.8.8")            //false
ip("192.168.0.1/24") == ip("8.8.8.8/8")       //false
ip("192.168.0.1/24") == ip("192.168.0.8/24")  //true
ip("127.0.0.1") == ip("::1")                  //false – different IP versions
ip("127.0.0.1") == "127.0.0.1"                //false – different types
ip("::1") == 1                                //false – different types
ip("127.0.0.1") == ip("192.168.0.1/24")       //false - address compared to range
ip("127.0.0.1") &lt; ip("10.0.0.10")             //error – invalid data types for &lt; operator
</code></pre></div></div> <h2 id="comparison-operators-and-functions"> <a href="#comparison-operators-and-functions" class="anchor-heading" aria-labelledby="comparison-operators-and-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Comparison operators and functions<a name="operators-comparison"></a> </h2> <p>Use these operators to compare two values as an expression. An expression that uses one of these operators evaluates to a Boolean <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>. You can then combine multiple expressions using the logical operators.</p> <h3 id="-equality"> <a href="#-equality" class="anchor-heading" aria-labelledby="-equality"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">==</code> (equality)<a name="operator-equality"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;any type&gt; == &lt;any type&gt;</code></p> <p>Binary operator that compares two operands of any type and evaluates to <code class="language-plaintext highlighter-rouge">true</code> only if they are exactly the same type and the same value. If the operands are of different types, the result is always <code class="language-plaintext highlighter-rouge">false</code>.</p> <h4 id="examples-1"> <a href="#examples-1" class="anchor-heading" aria-labelledby="examples-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>1 == 1                          //true
5 == "5"                        //false
"something" == "something"      //true
"Something" == "something"      //false
[1, -33, 707] == [1, -33]       //false
[1, 2, 40] == [1, 2, 40]        //true
[1, 2, 40] == [1, 40, 2]        //true
[1, -2, 40] == [1, 40]          //false
[1, 1, 1, 2, 40] == [40, 1, 2]  //true
[1, 1, 2, 1, 40, 2, 1, 2, 40, 1]== [1, 40, 1, 2]   //true
true == true                    //true
context.device_properties == {"os ":"Windows ", "version":11} 
                                //true if context.device_properties represents a Windows 11 computer
A == A                          //true even if A is an entity that doesn't exist
User::"alice" == User::"bob"    //false -- two different objects of same type
User::"alice" == Admin::"alice" //false -- objects of two different types
"alice" == User::"alice         //false -- string versus entity
</code></pre></div></div> <h3 id="-inequality"> <a href="#-inequality" class="anchor-heading" aria-labelledby="-inequality"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">!=</code> (inequality)<a name="operator-inequality"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;any type&gt; != &lt;any type&gt;</code></p> <p>Binary operator that compares two operands of any type and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the operands have different values or are of different types. You can use <code class="language-plaintext highlighter-rouge">!=</code> <strong><em>only</em></strong> in <code class="language-plaintext highlighter-rouge">when</code> and <code class="language-plaintext highlighter-rouge">unless</code> clauses.</p> <h4 id="example"> <a href="#example" class="anchor-heading" aria-labelledby="example"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>forbid(principal, action, resource)
when{
    resource.tag != "public"
};
</code></pre></div></div> <h3 id="-long-integer-less-than"> <a href="#-long-integer-less-than" class="anchor-heading" aria-labelledby="-long-integer-less-than"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">&lt;</code> (long integer ‘less than’)<a name="operator-lessthan"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;long&gt; &lt; &lt;long&gt;</code></p> <p>Binary operator that compares two long integer operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically less than the right operand.</p> <h4 id="examples-2"> <a href="#examples-2" class="anchor-heading" aria-labelledby="examples-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 &lt; 303               //true
principal.age &lt; 22    //true (assume principal.age is 21)
3 &lt; "3"               //type error
false &lt; true          //type error
"some" &lt; "thing"      //type error
"" &lt; "zzz"            //type error
"" &lt; ""               //type error
[1, 2] &lt; [47, 0]      //type error
</code></pre></div></div> <h3 id="lessthan-decimal-less-than"> <a href="#lessthan-decimal-less-than" class="anchor-heading" aria-labelledby="lessthan-decimal-less-than"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.lessThan()</code> (decimal ‘less than’)<a name="function-lessThan"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;decimal&gt;.lessThan(&lt;decimal&gt;)</code></p> <p>Function that compares two decimal operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically less than the right operand.</p> <h4 id="examples-3"> <a href="#examples-3" class="anchor-heading" aria-labelledby="examples-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decimal("1.23").lessThan(decimal("1.24"))     //true
decimal("1.23").lessThan(decimal("1.23"))     //false
decimal("123.45").lessThan(decimal("1.23"))   //false
decimal("-1.23").lessThan(decimal("1.23"))    //true
decimal("-1.23").lessThan(decimal("-1.24"))   //false
</code></pre></div></div> <h3 id="-long-integer-less-than-or-equal"> <a href="#-long-integer-less-than-or-equal" class="anchor-heading" aria-labelledby="-long-integer-less-than-or-equal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">&lt;=</code> (long integer ‘less than or equal’)<a name="operator-lessthanorequal"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;long&gt; &lt;= &lt;long&gt;</code></p> <p>Binary operator that compares two long integer operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically less than or equal to the right operand.</p> <h4 id="examples-4"> <a href="#examples-4" class="anchor-heading" aria-labelledby="examples-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 &lt;= 303               // true
principal.age &lt;= 21    // true (assume principal.age is 21)
3 &lt;= "3"               // type error
false &lt;= true          // type error
"some" &lt;= "thing"      // type error
"" &lt;= "zzz"            // type error
"" &lt;= ""               // type error
[1, 2] &lt;= [47, 0]      // type error
</code></pre></div></div> <h3 id="lessthanorequal-decimal-less-than-or-equal"> <a href="#lessthanorequal-decimal-less-than-or-equal" class="anchor-heading" aria-labelledby="lessthanorequal-decimal-less-than-or-equal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.lessThanOrEqual()</code> (decimal ‘less than or equal’)<a name="function-lessThanOrEqual"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;decimal&gt;.lessThanOrEqual(&lt;decimal&gt;)</code></p> <p>Function that compares two decimal operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically less than or equal to the right operand.</p> <h4 id="examples-5"> <a href="#examples-5" class="anchor-heading" aria-labelledby="examples-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decimal("1.23").lessThanOrEqual(decimal("1.24"))    // true
decimal("1.23").lessThanOrEqual(decimal("1.23"))    // true
decimal("123.45").lessThanOrEqual(decimal("1.23"))  // false
decimal("-1.23").lessThanOrEqual(decimal("1.23"))   // true
decimal("-1.23").lessThanOrEqual(decimal("-1.24"))  // false
</code></pre></div></div> <h3 id="-long-integer-greater-than"> <a href="#-long-integer-greater-than" class="anchor-heading" aria-labelledby="-long-integer-greater-than"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">&gt;</code> (long integer ‘greater than’)<a name="operator-greaterthan"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;long&gt; &gt; &lt;long&gt;</code></p> <p>Binary operator that compares two long integer operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically greater than the right operand.</p> <h4 id="examples-6"> <a href="#examples-6" class="anchor-heading" aria-labelledby="examples-6"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 &gt; 303                // false
principal.age &gt; 22     // false (assume principal.age is 21)
3 &lt;= "3"               // type error
false &lt;= true          // type error
"some" &lt;= "thing"      // type error
"" &lt;= "zzz"            // type error
"" &lt;= ""               // type error
[1, 2] &lt;= [47, 0]      // type error
</code></pre></div></div> <h3 id="greaterthan-decimal-greater-than-or-equal"> <a href="#greaterthan-decimal-greater-than-or-equal" class="anchor-heading" aria-labelledby="greaterthan-decimal-greater-than-or-equal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.greaterThan()</code> (decimal ‘greater than or equal’)<a name="function-greaterThan"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;decimal&gt;.greaterThan(&lt;decimal&gt;)</code></p> <p>Function that compares two decimal operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically greater than the right operand.</p> <h4 id="examples-7"> <a href="#examples-7" class="anchor-heading" aria-labelledby="examples-7"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decimal("1.23").greaterThan(decimal("1.24"))    // false
decimal("1.23").greaterThan(decimal("1.23"))    // false
decimal("123.45").greaterThan(decimal("1.23"))  // true
decimal("-1.23").greaterThan(decimal("1.23"))   // false
decimal("-1.23").greaterThan(decimal("-1.24"))  // true
</code></pre></div></div> <h3 id="-long-integer-greater-than-or-equals"> <a href="#-long-integer-greater-than-or-equals" class="anchor-heading" aria-labelledby="-long-integer-greater-than-or-equals"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">&gt;=</code> (Long integer ‘greater than or equals’)<a name="operator-greaterthanorequal"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;long&gt; &gt;= &lt;long&gt;</code></p> <p>Binary operator that compares two long integer operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically greater than or equal to the right operand.</p> <h4 id="examples-8"> <a href="#examples-8" class="anchor-heading" aria-labelledby="examples-8"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>3 &gt;= 303               //false
principal.age &gt;= 21    //true (assume principal.age is 21)
3 &gt;= "3"               //type error
false &gt;= true          //type error
"some" &gt;= "thing"      //type error
"" &gt;= "zzz"            //type error
"" &gt;= ""               //type error
[1, 2] &gt;= [47, 0]      //type error
</code></pre></div></div> <h3 id="greaterthanorequal-decimal-greater-than-or-equal"> <a href="#greaterthanorequal-decimal-greater-than-or-equal" class="anchor-heading" aria-labelledby="greaterthanorequal-decimal-greater-than-or-equal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.greaterThanOrEqual()</code> (decimal ‘greater than or equal’)<a name="function-greaterThanOrEqual"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;decimal&gt;.greaterThanOrEqual(&lt;decimal&gt;)</code></p> <p>Function that compares two decimal operands and evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand is numerically greater than or equal to the right operand.</p> <h4 id="examples-9"> <a href="#examples-9" class="anchor-heading" aria-labelledby="examples-9"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>decimal("1.23").greaterThanOrEqual(decimal("1.24"))    //false
decimal("1.23").greaterThanOrEqual(decimal("1.23"))    //true
decimal("123.45").greaterThanOrEqual(decimal("1.23"))  //true
decimal("-1.23").greaterThanOrEqual(decimal("1.23"))   //false
decimal("-1.23").greaterThanOrEqual(decimal("-1.24"))  //true
</code></pre></div></div> <h2 id="logical-operators"> <a href="#logical-operators" class="anchor-heading" aria-labelledby="logical-operators"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Logical operators<a name="operators-logical"></a> </h2> <p>Use these operators to logically combine Boolean values or expressions.</p> <h3 id="-and"> <a href="#-and" class="anchor-heading" aria-labelledby="-and"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> (AND)<a name="operator-and"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;Boolean&gt; &amp;&amp; &lt;Boolean&gt;</code></p> <p>Binary operator that evaluates to <code class="language-plaintext highlighter-rouge">true</code> only if both arguments are <code class="language-plaintext highlighter-rouge">true</code>.</p> <p>In the following policy, the <code class="language-plaintext highlighter-rouge">when</code> condition is <code class="language-plaintext highlighter-rouge">true</code> if both <code class="language-plaintext highlighter-rouge">principal.numberOfLaptops &lt; 5</code> and p<code class="language-plaintext highlighter-rouge">rincipal.jobLevel &gt; 6</code> are <code class="language-plaintext highlighter-rouge">true</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>permit(principal, action == Action::"remoteAcces s ", res ource)
when {
    principal.numberO fLaptops &lt; 5 &amp;&amp;
    principal.jobLevel &gt; 6
}
</code></pre></div></div> <p>The <code class="language-plaintext highlighter-rouge">&amp;&amp;</code> operator uses <a href="https://wikipedia.org/wiki/Short-circuit_evaluation">short circuit evaluation</a>. If the first argument is <code class="language-plaintext highlighter-rouge">false</code>, then the expression immediately evaluates to <code class="language-plaintext highlighter-rouge">false</code> and the second argument isn’t evaluated. This approach is useful when the second argument might result in an error if evaluated. You can use the first argument to test that the second argument is a valid expression.</p> <p>The following policy allows only if the principal has the attribute <code class="language-plaintext highlighter-rouge">level</code> and the <code class="language-plaintext highlighter-rouge">level &gt; 5</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>permit(principal, action == Action:"read", res ource)
when {
    principal has level &amp;&amp;
    principal.level &gt; 5
};
</code></pre></div></div> <p>The second comparison in this expression is valid only if the <code class="language-plaintext highlighter-rouge">numberOfLaptops</code> property for the <code class="language-plaintext highlighter-rouge">principal</code> entity has a value. If it doesn’t, the less than operator generates an error. The first expression uses the <a href="#operator-has"><strong>has</strong></a> operator to ensure that the <code class="language-plaintext highlighter-rouge">principal</code> entity does have such a property with a value. If that evaluates to <code class="language-plaintext highlighter-rouge">false</code>, then the second expression isn’t evaluated.</p> <h4 id="more-examples-1"> <a href="#more-examples-1" class="anchor-heading" aria-labelledby="more-examples-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>false &amp;&amp; 3          //false
(false &amp;&amp; 3) == 3   //false, short-circuiting
true &amp;&amp; 3           //type error
3 &amp;&amp; false          // type error
</code></pre></div></div> <h3 id="-or"> <a href="#-or" class="anchor-heading" aria-labelledby="-or"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">||</code> (OR)<a name="operator-or"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;Boolean&gt; || &lt;Boolean&gt;</code></p> <p>Binary operator that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if either one or both arguments are <code class="language-plaintext highlighter-rouge">true</code>.</p> <p>This operator uses <a href="https://wikipedia.org/wiki/Short-circuit_evaluation">short circuit evaluation</a>. If the first argument is <code class="language-plaintext highlighter-rouge">true</code>, then the expression immediately evaluates to <code class="language-plaintext highlighter-rouge">true</code> and the second argument isn’t evaluated. This approach is useful when the second argument might result in an error if evaluated. The first argument should be a test that can determine if the second argument is a valid expression. For example, consider the following expression. It evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the principal can’t be confirmed to at least 21 years old and <code class="language-plaintext highlighter-rouge">principal</code> is either missing the <code class="language-plaintext highlighter-rouge">age</code> property or that property is set to a value less than 21.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>!(principal has age) || principal.age &lt; 21 
</code></pre></div></div> <p>The second comparison in this expression is valid only if the <code class="language-plaintext highlighter-rouge">age</code> property for the <code class="language-plaintext highlighter-rouge">principal</code> entity is present. If it is missing, the less than operator generates an error. The first expression uses the <a href="#operator-has"><strong>has</strong></a> operator, inverted by the <code class="language-plaintext highlighter-rouge">!</code> <strong><a href="#operator-not">NOT</a></strong> operator, to flag that the <code class="language-plaintext highlighter-rouge">principal</code> entity is missing the <code class="language-plaintext highlighter-rouge">age</code> property. If that evaluates to <code class="language-plaintext highlighter-rouge">true</code>, there is no test of the second expression.</p> <p>The following policy allows if either <code class="language-plaintext highlighter-rouge">resource.owner == principal</code> or <code class="language-plaintext highlighter-rouge">resource.tag == "public"</code> is true.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>permit(principal, action == Action:"read", resource)
when {
    resource.owner == principal ||
    resource.tag == "public"
}
</code></pre></div></div> <h4 id="more-examples-2"> <a href="#more-examples-2" class="anchor-heading" aria-labelledby="more-examples-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>true || 3                  //true, short-circuiting
false || 3                 //type error
3 || true                  //type error
(true || 3) == 3           //false, short-circuiting
(true || 3 || true) == 3   //false, short-circuiting
</code></pre></div></div> <h3 id="-not"> <a href="#-not" class="anchor-heading" aria-labelledby="-not"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">!</code> (NOT)<a name="operator-not"></a> </h3> <p><strong>Usage:</strong> ` ! <Boolean>`</Boolean></p> <p>Unary operator with only one argument. It inverts the value of the Boolean operand from <code class="language-plaintext highlighter-rouge">true</code> to <code class="language-plaintext highlighter-rouge">false</code>, or from <code class="language-plaintext highlighter-rouge">false</code> to <code class="language-plaintext highlighter-rouge">true</code>.</p> <h4 id="example-1"> <a href="#example-1" class="anchor-heading" aria-labelledby="example-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example: </h4> <p>The following policy forbids if the principal does not belong to Group::”family”.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>forbid(principal, action, resource)
when {
    !(principal in Group::"family")
};
</code></pre></div></div> <p>You can rewrite the above policy using an <code class="language-plaintext highlighter-rouge">unless</code> clause as:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>forbid(principal, action, resource)
unless {
  principal in Group::"family"
};
</code></pre></div></div> <h4 id="more-examples-3"> <a href="#more-examples-3" class="anchor-heading" aria-labelledby="more-examples-3"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>! true                                // false
! false                               // true
! 8                                   // type error
if !true then "hello" else "goodbye"  // "goodbye"
</code></pre></div></div> <h2 id="arithmetic-operators"> <a href="#arithmetic-operators" class="anchor-heading" aria-labelledby="arithmetic-operators"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Arithmetic operators<a name="operators-math"></a> </h2> <p>Use these operators to perform arithmetic operations on long integer values.</p> <p><strong>Notes</strong><br /> The arithmetic operators support <strong><em>only</em></strong> values of type <code class="language-plaintext highlighter-rouge">Long</code>. They don’t support values of type <code class="language-plaintext highlighter-rouge">Decimal</code>. There is no operator for arithmetic division. The arithmetic operators generate errors if they overflow out of the <code class="language-plaintext highlighter-rouge">Long</code> integer range from <code class="language-plaintext highlighter-rouge">-9223372036854775808</code> to <code class="language-plaintext highlighter-rouge">9223372036854775807</code>.</p> <h3 id="-numeric-addition"> <a href="#-numeric-addition" class="anchor-heading" aria-labelledby="-numeric-addition"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">+</code> (Numeric addition)<a name="operator-add"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;long&gt; + &lt;long&gt;</code></p> <p>Binary operator that adds the two long integer values and returns a long integer sum.</p> <h4 id="example-2"> <a href="#example-2" class="anchor-heading" aria-labelledby="example-2"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Example: </h4> <p>The following policy returns <code class="language-plaintext highlighter-rouge">allow</code> if the context <code class="language-plaintext highlighter-rouge">budget</code> minus the context <code class="language-plaintext highlighter-rouge">downloaded</code> is greater than 100.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>permit(principal, action, resource)
when {
    context.budget - context.downloaded &gt; 100
};
</code></pre></div></div> <h4 id="other-examples"> <a href="#other-examples" class="anchor-heading" aria-labelledby="other-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Other examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>11 + 0                              // 11
-1 + 1                              // 0
9,223,372,036,854,775,807 + 1       //overflow
-9,223,372,036,854,775,808 - 1 + 3  //overflow
7 + "3"                             //type error
"lamp" + "la"                       //type error - no support for string concatenation
</code></pre></div></div> <h3 id="--numeric-subtraction-or-negation"> <a href="#--numeric-subtraction-or-negation" class="anchor-heading" aria-labelledby="--numeric-subtraction-or-negation"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">-</code> (Numeric subtraction or negation)<a name="operator-subtract"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;long&gt; - &lt;long&gt;</code></p> <p>As a binary operator with two operands, it subtracts the second long integer value from the first and returns a long integer difference.</p> <h4 id="examples-10"> <a href="#examples-10" class="anchor-heading" aria-labelledby="examples-10"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>44 - 31                             // 13
5 - (-3)                            // 8
-9,223,372,036,854,775,808 - 1 + 3  // overflow
</code></pre></div></div> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">- &lt;long&gt;</code></p> <p>As a unary operator with one operand, it returns the negative of the value.</p> <h4 id="examples-11"> <a href="#examples-11" class="anchor-heading" aria-labelledby="examples-11"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>-3
</code></pre></div></div> <h3 id="-numeric-multiplication"> <a href="#-numeric-multiplication" class="anchor-heading" aria-labelledby="-numeric-multiplication"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">*</code> (Numeric multiplication)<a name="operator-multiply"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;long&gt; * &lt;long&gt;</code></p> <p>Binary operator that multiplies two long integer values and returns a long integer product. One of the values <strong><em>must</em></strong> be an integer literal, the other value can be an integer literal or an expression that evaluates to an integer value.</p> <blockquote class="note"> <p>There is no operator for arithmetic division.</p> </blockquote> <h4 id="examples-12"> <a href="#examples-12" class="anchor-heading" aria-labelledby="examples-12"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>10 * 20                          // 200
res ource.value * 10             // valid
2 * context.budget &gt; 100         // valid
context.budget * context.limit   // not valid. One operand must be a constant
9223372036854775807 * 2          // overflow
5 * (-3)                         // -15
5 * 0                            // 0
"5" * 0                          // type error
</code></pre></div></div> <h2 id="hierarchy-and-set-membership-operators-and-functions"> <a href="#hierarchy-and-set-membership-operators-and-functions" class="anchor-heading" aria-labelledby="hierarchy-and-set-membership-operators-and-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Hierarchy and set membership operators and functions<a name="functions-set"></a> </h2> <p>Use these functions to test if entities are members of a hierarchy or a set.</p> <h3 id="in-hierarchy-membership"> <a href="#in-hierarchy-membership" class="anchor-heading" aria-labelledby="in-hierarchy-membership"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">in</code> (Hierarchy membership)<a name="operator-in"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;entity&gt; in &lt;entity&gt;</code></p> <p>Boolean operator that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the entity in the left operand is a descendant in the hierarchy under the entity in the right operand.</p> <p>The <code class="language-plaintext highlighter-rouge">in</code> operator is transitive. If <code class="language-plaintext highlighter-rouge">A</code> is in <code class="language-plaintext highlighter-rouge">B</code>, and <code class="language-plaintext highlighter-rouge">B</code> is in <code class="language-plaintext highlighter-rouge">C</code>, then <code class="language-plaintext highlighter-rouge">A</code> is also in <code class="language-plaintext highlighter-rouge">C</code>. This approach allows you to model the concept of a multi-tier hierarchy, for example nesting folders in other folders.</p> <p>The <code class="language-plaintext highlighter-rouge">in</code> operator is reflexive; If the right operand is a single entity, then the expression evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the right entity is the same as the left entity. In other words, an entity is <em>always</em> in its own hierarchy. <code class="language-plaintext highlighter-rouge">A</code> is always in <code class="language-plaintext highlighter-rouge">A</code>.</p> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;entity&gt; in set(&lt;entity&gt;, &lt;entity&gt;, ...)</code></p> <h4 id="examples-13"> <a href="#examples-13" class="anchor-heading" aria-labelledby="examples-13"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <p>For example, assume that the <code class="language-plaintext highlighter-rouge">principal</code> in a request is <code class="language-plaintext highlighter-rouge">User::"12345"</code></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>principal in User::"12345"     // true - testing if a value is in itself always returns true
principal in [User::"12345"]   // true - testing if a value is in a set consisting of only itself always returns true
principal in Group::"67890"    // true if User::"12345" belongs to Group::"67890"
principal in [Group::"67890"]  // true if User::"12345" belongs to Group::"67890"
</code></pre></div></div> <h4 id="more-examples-4"> <a href="#more-examples-4" class="anchor-heading" aria-labelledby="more-examples-4"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More examples: </h4> <p>Consider the following set of entities:</p> <p><img src="/images/entities.png" alt="Example entities" /></p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User::"jane" in User::"jane"           // true - `in` is reflexive
User::"bob" in Group::"jane_friends"   // true - Group::"jane_friends" is an ancestor of User::"bob".
User::"john" in Group::"jane_friends"  // false - User::"john"'s only ancestor is Group"jane_coworkers".
</code></pre></div></div> <p>If the right operand is a set of entities, then the expression is evaluated for each member in the set. For example, consider the following expression.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A in [ B, C, D ]
</code></pre></div></div> <p>That expression is evaluated as component expressions joined by the <a href="#operator-or">logical OR operator</a>, as shown in the following example.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A in B || A in C || A in D 
</code></pre></div></div> <p>If any one or more of the component expressions evaluates to <code class="language-plaintext highlighter-rouge">true</code>, then the overall expression evaluates to <code class="language-plaintext highlighter-rouge">true</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User::"bob" in [Group::"jane_friends"] // true
User::"alice" in [ 
    Group::"jane_family", 
    Group::"jane_friends "
]                                      // true - User::"Alice" is a member of Group::"jane_friends"
User::"alice" in [
    User::"bob", 
    User::"alice"
]                                      // true - User::"alice" in User::"alice"
User::"john" in [
    Group::"jane_family",
    Group::"jane_friends"
]                                      // false - User::"john" isn't a member of any entities in the set
</code></pre></div></div> <p>The right operand of in can be any expression that returns a set of entity references, not just a set literal. For example, suppose the query context contains the following:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
    "groups ": [Group::"jane_family", Group::"jane_friends "]
}
</code></pre></div></div> <p>Then the following two expressions in a policy statement are equivalent:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User::"alice" in context.groups 
User::"alice" in [Group::"jane_family", Group::"jane_friends"]
</code></pre></div></div> <p>However, the following expression raises a type error because “Team” is a string, not an entity reference.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>User::"alice" in [User::"alice", Group::"jane_friends", "Team"]   // type error
</code></pre></div></div> <p>Because the in operator is reflexive, A in A returns true even if the entity A does not exist. The evaluator treats entity references that are not in the hierarchy as a valid entity. For example:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stranger::"jimmy" in Stranger::"jimmy"        // true by reflexivity.
Stranger::"jimmy" in Group::"jane_friends"    // false - Stranger::"jimmy" does not refer to an existing entity
Stranger::"jimmy" in [
    Group::"jane_family",
    Stranger::"jimmy"
]                                             // true - Stranger::"jimmy" in Stranger::"jimmy" is true
</code></pre></div></div> <h4 id="more-examples-5"> <a href="#more-examples-5" class="anchor-heading" aria-labelledby="more-examples-5"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> More Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"some" in ["some", "thing"] //type error - these are strings, not entities. For strings, use `contains` for set membership.
"os" in {"os":"Windows "}   //type error - use `has` operator to check if a key exists
</code></pre></div></div> <h3 id="has-presence-of-attribute-test"> <a href="#has-presence-of-attribute-test" class="anchor-heading" aria-labelledby="has-presence-of-attribute-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">has</code> (presence of attribute test)<a name="operator-has"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;entity&gt; has &lt;attribute&gt;</code></p> <p>Boolean operator that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the left operand has a value defined for the specified attribute. Use this operator to check that a value is present before accessing that value. If you attempt to access a value that isn’t defined, then Cedar generates an error.</p> <p>The following example expression first tests whether the entity <code class="language-plaintext highlighter-rouge">A</code> has a defined attribute <code class="language-plaintext highlighter-rouge">B</code>. Because the <a href="#operator-and">&amp;&amp;</a> operator uses shortcut logic, the second expression is evaluated and the attribute accessed <em>only</em> if the attribute is present.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>A has B &amp;&amp; A.B == 5
</code></pre></div></div> <p>In the following example, assume that the request has the following context:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"context":{
    "role": ["admin", "us er"],
    "addr": { "s treet": "main", "city": "DC"}
    "owner info": { "name": "Alice", "age": 18 }
}
</code></pre></div></div> <p>The following condition checks if the context has an attribute <code class="language-plaintext highlighter-rouge">role</code>. If the attribute exists, then it checks if it is a set containing the string <code class="language-plaintext highlighter-rouge">"admin"</code> as an element.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context has role &amp;&amp; context.role.contains("admin")       //true
</code></pre></div></div> <p>The attribute name <code class="language-plaintext highlighter-rouge">role</code> can be written as an identifier (as in the previious example) or as a string literal. The following expression is equivalent to the previous one:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context has "role" &amp;&amp; context.role.contains("admin")     //true
</code></pre></div></div> <p>You must check for presence of optional attributes that are nested multiple layers one at a time. For example, to check for the presence of <code class="language-plaintext highlighter-rouge">principal.custom.project</code>, you must first check if <code class="language-plaintext highlighter-rouge">principal</code> has a <code class="language-plaintext highlighter-rouge">custom</code> attribute. You can then check to see if that <code class="language-plaintext highlighter-rouge">custom</code> attribute has a <code class="language-plaintext highlighter-rouge">project</code> attribute. To do this, you could use the following syntax.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>principal has custom &amp;&amp; principal.custom has project 
</code></pre></div></div> <p>If the attribute name is not valid as an identifier, then the string literal syntax must be used for <code class="language-plaintext highlighter-rouge">has</code> and attribute values must be accessed with the <code class="language-plaintext highlighter-rouge">[]</code> operator instead of using dot syntax. For example, to check if <code class="language-plaintext highlighter-rouge">context</code> has an attribute called <code class="language-plaintext highlighter-rouge">owner info</code> (with an embedded space), then you could use the following syntax.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context has "owner info" &amp;&amp; context["owner info"].name == "Alice"    //true
</code></pre></div></div> <p>The following expression returns false because <code class="language-plaintext highlighter-rouge">context</code> doesn’t have an attribute <code class="language-plaintext highlighter-rouge">tag</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context has tag      //false
</code></pre></div></div> <p>The following expression returns a type error because the left-hand side of the <code class="language-plaintext highlighter-rouge">has</code> operator must be an entity or a record. In this example, because <code class="language-plaintext highlighter-rouge">role</code> is a set, Cedar generates a type error.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context.role has admin     //type error
</code></pre></div></div> <p>The following expression returns <code class="language-plaintext highlighter-rouge">false</code> because the <code class="language-plaintext highlighter-rouge">addr</code> sub-record does not have an attribute <code class="language-plaintext highlighter-rouge">country</code>. The second expression is not evaluated.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context.addr has country &amp;&amp; context.addr.country == "US "    //false
</code></pre></div></div> <p>However, consider the case where <code class="language-plaintext highlighter-rouge">context</code> does not have the <code class="language-plaintext highlighter-rouge">addr</code> sub-record at all:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>"context": {
    "role": ["admin", "user"]
}
</code></pre></div></div> <p>In that case, then the previous expression that checks for <code class="language-plaintext highlighter-rouge">context.addr has country</code> raises a missing-attribute error on <code class="language-plaintext highlighter-rouge">context.addr</code> before the <code class="language-plaintext highlighter-rouge">has</code> operator is even evaluated, and the entire policy is skipped. If the <code class="language-plaintext highlighter-rouge">addr</code> sub-record is optional, you can avoid this error by checking whether <code class="language-plaintext highlighter-rouge">addr</code> is present before accessing it with the <code class="language-plaintext highlighter-rouge">.</code> operator:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>context has addr &amp;&amp; context.addr has country &amp;&amp; context.addr.country == "US"  // false, with no error
</code></pre></div></div> <h3 id="contains-single-element-set-membership-test"> <a href="#contains-single-element-set-membership-test" class="anchor-heading" aria-labelledby="contains-single-element-set-membership-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.contains()</code> (single element set membership test)<a name="function-contains"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;set&gt;.contains(&lt;entity&gt;)</code></p> <p>Function that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the operand is a member of the receiver on the left side of the function. The receiver must be of type <code class="language-plaintext highlighter-rouge">set</code>.</p> <h4 id="examples-14"> <a href="#examples-14" class="anchor-heading" aria-labelledby="examples-14"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples: </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1,2,3].contains (1)                            // true
[1,"something",2].contains(1)                   // true
[1,"something",2].contains("Something")         // false - string comparision is case-sensitive
["some", "useful", "tags"].contains("useful")   // true
[].contains (100)                               // false
context.role.contains ("admin")                 // true if the set `role` contains the string "admin"
[User::"alice"].contains (principal)            // true if principal == User::"alice"
"ham and ham".contains ("ham")                  // type error - 'contains' is not allowed on strings
</code></pre></div></div> <h3 id="containsall-all-element-set-membership-test"> <a href="#containsall-all-element-set-membership-test" class="anchor-heading" aria-labelledby="containsall-all-element-set-membership-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.containsAll()</code> (all element set membership test)<a name="function-containsAll"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;set&gt;.containsAll(&lt;set&gt;)</code></p> <p>Function that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if <em>every</em> member of the operand set is a member of the receiver set. Both the receiver and the operand must be of type <code class="language-plaintext highlighter-rouge">set</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1, -22, 34].containsAll([-22, 1])                           // true
[1, -22, 34].containsAll([-22])                              // true
[43, 34].containsAll([34, 43])                               // true
[1, -2, 34].containsall([1, -22])                            // false
[1, 34].containsAll [1, 101, 34]                             // false
[false, 3, [47, 0], "some"].containsAll([3, "some"])         // true
[false, 3, [47, 0], {"2": "ham"}].containsAll([3, {"2": "ham"}])  // true
[2, 43].containsAll([])                                      // true
[].containsAll([2, 43])                                      // false
[false, 3, [47, 0], "thing"].containsAll("thing")            // type error - operand a string
"ham and eggs".containsAll("ham")                            // type error - prefix and operand are strings
{"2": "ham", "3": "eggs "}.containsAll({"2": "ham"})         // type error - prefix and operand are records
</code></pre></div></div> <h3 id="containsany-any-element-set-membership-test"> <a href="#containsany-any-element-set-membership-test" class="anchor-heading" aria-labelledby="containsany-any-element-set-membership-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.containsAny()</code> (any element set membership test)<a name="function-containsAny"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;set&gt;.containsAny(&lt;set&gt;)</code></p> <p>Function that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if <em>any one or more</em> members of the operand set is a member of the receiver set. Both the receiver and the operand must be of type <code class="language-plaintext highlighter-rouge">set</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[1, -22, 34].containsAny([1, -22])                             // true
[1, -22].containsAny([1, -22, 34])                             // true
[-22].containsAny([1, -22, 34])                                // true
[1, 101].containsAny([1, -22, 34])                             // true
[1, 101].containsAny([-22, 34])                                // false
["alice","bob","charlie"].containsAny(["david","bob","juan"])  // true
[].containsAny(["bob"])                                        // false
["bob"].containsAny([])                                        // false
"ham".containsAny("ham and eggs")                              // type error - operand is a string
{"2": "ham"}.containsAny({"2": "ham", "3": "eggs "})           // type error - prefix and operands are records
</code></pre></div></div> <h2 id="ip-address-functions"> <a href="#ip-address-functions" class="anchor-heading" aria-labelledby="ip-address-functions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> IP address functions<a name="functions-ipaddr"></a> </h2> <p>Use these functions to test characteristics of IP addresses and ranges.</p> <h3 id="isipv4-ipv4-address-valid-test"> <a href="#isipv4-ipv4-address-valid-test" class="anchor-heading" aria-labelledby="isipv4-ipv4-address-valid-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.isIpv4()</code> (IPv4 address valid test)<a name="function-isIpv4"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;ipaddr&gt;.isIpv4()</code></p> <p>Evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the receiver is an IPv4 address. This function takes no operand.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip("127.0.0.1").isIpV4()     //true
ip("::1").isIpV4()           //false
ip("127.0.0.1/24").isIpV4()  //true
</code></pre></div></div> <h3 id="isipv6-ipv6-address-valid-test"> <a href="#isipv6-ipv6-address-valid-test" class="anchor-heading" aria-labelledby="isipv6-ipv6-address-valid-test"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.isIpv6()</code> (IPv6 address valid test)<a name="function-isIpv6.title"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;ipaddr&gt;.isIpv6()</code></p> <p>Function that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the receiver is an IPv6 address. This function takes no operand.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip("127.0.0.1/24").isIpV6()  //false
ip("ffee::/64").isIpV6()     //true
ip("::1").isIpV6()           //true
</code></pre></div></div> <h3 id="isloopback-test-for-ip-loopback-address"> <a href="#isloopback-test-for-ip-loopback-address" class="anchor-heading" aria-labelledby="isloopback-test-for-ip-loopback-address"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.isLoopback()</code> (test for IP loopback address)<a name="function-isLoopback.title"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;ipaddr&gt;.isLoopback()</code></p> <p>Function that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the receiver is a valid loopback address for its IP version type. This function takes no operand.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip("127.0.0.2").isLoopback()  //true
ip("::1").isLoopback()        //true
ip("::2").isLoopback()        //false
</code></pre></div></div> <h3 id="ismulticast-test-for-multicast-address"> <a href="#ismulticast-test-for-multicast-address" class="anchor-heading" aria-labelledby="ismulticast-test-for-multicast-address"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.isMulticast()</code> (test for multicast address)<a name="function-isMulticast.title"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;ipaddr&gt;.isMulticast()</code></p> <p>Function that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the receiver is a multicast address for its IP version type. This function takes no operand.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip("127.0.0.1").isMulticast()  //false
ip("ff00::2").isMulticast()    //true
</code></pre></div></div> <h3 id="isinrange-test-for-inclusion-in-ip-address-range"> <a href="#isinrange-test-for-inclusion-in-ip-address-range" class="anchor-heading" aria-labelledby="isinrange-test-for-inclusion-in-ip-address-range"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">.isInRange()</code> (test for inclusion in IP address range)<a name="function-isInRange.title"></a> </h3> <p><strong>Usage:</strong> <code class="language-plaintext highlighter-rouge">&lt;ipaddr&gt;.isInRange(&lt;ipaddr&gt;)</code></p> <p>Function that evaluates to <code class="language-plaintext highlighter-rouge">true</code> if the receiver is an IP address or a range of addresses that fall completely within the range specified by the operand.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip("192.168.0.1").isInRange(ip("192.168.0.1/24"))   //true
ip("192.168.0.1").isInRange(ip("192.168.0.1/28"))   //true
ip("192.168.0.75").isInRange(ip("192.168.0.1/24"))  //true
ip("192.168.0.75").isInRange(ip("192.168.0.1/28"))  //false
ip("1:2:3:4::/48").isInRange(ip("1:2:3:4::"))       //true
ip("192.168.0.1").isInRange(ip("1:2:3:4::"))        //false
</code></pre></div></div> </main> <hr> <footer> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/cedar-policy/cedar-docs/tree/main/docs/syntax-operators.md" id="edit-this-page">We welcome your feedback. You can edit this page on GitHub.</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
