<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script src="/assets/js/vendor/lunr.min.js"></script> <script src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Basic syntax | Cedar Policy Language Version 2.3 Reference Guide</title> <meta name="generator" content="Jekyll v3.9.3" /> <meta property="og:title" content="Basic syntax" /> <meta property="og:locale" content="en_US" /> <link rel="canonical" href="http://localhost:4000/syntax-policy.html" /> <meta property="og:url" content="http://localhost:4000/syntax-policy.html" /> <meta property="og:site_name" content="Cedar Policy Language Version 2.3 Reference Guide" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Basic syntax" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","headline":"Basic syntax","publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/images/Cedar1-green.png"}},"url":"http://localhost:4000/syntax-policy.html"}</script> <!-- End Jekyll SEO tag --> </head> <body> <a class="skip-to-main" href="#main-content">Skip to main content</a> <svg xmlns="http://www.w3.org/2000/svg" class="d-none"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <!-- Feather. MIT License: https://github.com/feathericons/feather/blob/master/LICENSE --> <symbol id="svg-external-link" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"> <title id="svg-external-link-title">(external link)</title> <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <!-- Bootstrap Icons. MIT License: https://github.com/twbs/icons/blob/main/LICENSE.md --> <symbol id="svg-copy" viewBox="0 0 16 16"> <title>Copy</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard" viewBox="0 0 16 16"> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"/> <path d="M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"/> </svg> </symbol> <symbol id="svg-copied" viewBox="0 0 16 16"> <title>Copied</title> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-clipboard-check-fill" viewBox="0 0 16 16"> <path d="M6.5 0A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3Zm3 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3Z"/> <path d="M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1A2.5 2.5 0 0 1 9.5 5h-3A2.5 2.5 0 0 1 4 2.5v-1Zm6.854 7.354-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708.708Z"/> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header" role="banner"> <a href="/" class="site-title lh-tight"> <div class="site-logo" role="img" aria-label="Cedar Policy Language Version 2.3 Reference Guide"></div> </a> <button id="menu-button" class="site-button btn-reset" aria-label="Toggle menu" aria-pressed="false"> <svg viewBox="0 0 24 24" class="icon" aria-hidden="true"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="/" class="nav-list-link">Table of contents</a></li><li class="nav-list-item"><a href="/what-is-cedar.html" class="nav-list-link">What is Cedar?</a></li><li class="nav-list-item"><a href="/terminology.html" class="nav-list-link">Terms & concepts</a></li><li class="nav-list-item"><a href="/scenario.html" class="nav-list-link">Example scenario</a></li><li class="nav-list-item"><a href="/authorization.html" class="nav-list-link">Authorization</a></li><li class="nav-list-item"><a href="/validation.html" class="nav-list-link">Policy validation</a></li><li class="nav-list-item"><a href="/schema.html" class="nav-list-link">Schema format</a></li><li class="nav-list-item"><a href="/templates.html" class="nav-list-link">Policy templates</a></li><li class="nav-list-item active"><button class="nav-list-expander btn-reset" aria-label="toggle items in Policy syntax category" aria-pressed="true"> <svg viewBox="0 0 24 24" aria-hidden="true"><use xlink:href="#svg-arrow-right"></use></svg> </button><a href="/syntax.html" class="nav-list-link">Policy syntax</a><ul class="nav-list"><li class="nav-list-item active"><a href="/syntax-policy.html" class="nav-list-link active">Basic syntax</a></li><li class="nav-list-item "><a href="/syntax-entity.html" class="nav-list-link">Entity</a></li><li class="nav-list-item "><a href="/syntax-datatypes.html" class="nav-list-link">Data types</a></li><li class="nav-list-item "><a href="/syntax-operators.html" class="nav-list-link">Operators</a></li><li class="nav-list-item "><a href="/syntax-grammar.html" class="nav-list-link">Grammar</a></li></ul></li><li class="nav-list-item"><a href="/security.html" class="nav-list-link">Security</a></li><li class="nav-list-item"><a href="/doc-history.html" class="nav-list-link">Document history</a></li><li class="nav-list-item"><a href="/about/" class="nav-list-link">About</a></li></ul> </nav> <p>We welcome your feedback about these docs!<br> <a href="mailto:cedar-docs@amazon.com?subject=Feedback&body=My%20name%20%28optional%29:%0D%0A%0D%0AMy%20email%20%28optional%29:%0D%0A%0D%0AWhat%20I%20was%20trying%20to%20do:%0D%0A%0D%0AWhat%20to%20make%20better:">Send feedback by email</a> or use <a href="https://github.com/cedar-policy/cedar-docs/issues">GitHub Issues</a></p> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search" role="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search Cedar Policy Language Version 2.3 Reference Guide" aria-label="Search Cedar Policy Language Version 2.3 Reference Guide" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="/syntax.html">Policy syntax</a></li> <li class="breadcrumb-nav-list-item"><span>Basic syntax</span></li> </ol> </nav> <div id="main-content" class="main-content"> <main> <h1 class="no_toc" id="basic-policy-construction-in-cedar"> <a href="#basic-policy-construction-in-cedar" class="anchor-heading" aria-labelledby="basic-policy-construction-in-cedar"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Basic policy construction in Cedar<a name="syntax-policy"></a> </h1> <p>A policy is a text document that includes the following elements:</p> <ul> <li> <p><strong><a href="#term-policy-effect">Effect</a></strong> – The effect specifies the <em>intent</em> of the policy, to either <em>permit</em>` or <em>forbid</em> any request that matches the scope and conditions specified in the policy.</p> </li> <li> <p><strong><a href="#term-policy-scope">Scope</a></strong> – The scope specifies the combination of principals, actions, and resources to which the policy applies. Inclusion of these elements is mandatory. A policy that has <em>only</em> a scope without additional context conditions can be part of a <a href="https://wikipedia.org/wiki/Role-based_access_control">role-based access control</a> strategy.</p> </li> <li> <p><strong><a href="#term-parc-context">Conditions</a></strong> – <em>(Optional)</em> You can optionally provide additional conditions. These conditions must be satisfied for the policy to affect the evaluation of the authorization request. These conditions are expressed as <code class="language-plaintext highlighter-rouge">when</code> and <code class="language-plaintext highlighter-rouge">unless</code> clauses. You can use the conditions to evaluate the attributes of the principals, resources, and other elements that make up the context of the request. A policy that includes conditions can be part of an <a href="https://wikipedia.org/wiki/Attribute-based_access_control">attribute-based access control</a> strategy.</p> </li> <li> <p><strong><a href="#term-parc-annotations">Annotations</a></strong> – <em>(Optional)</em> An annotation is an arbitrary string value that can be used by other services that read and process Cedar policies. An annotation has no impact on policy evaluation.</p> </li> </ul> <p>The policy must end with a semicolon character (<code class="language-plaintext highlighter-rouge">;</code>).</p> <p>When the request exactly matches the scope, and all of the context conditions evaluate to <code class="language-plaintext highlighter-rouge">true</code>, then that policy evaluates to <code class="language-plaintext highlighter-rouge">true</code>. This process repeats for all policies that are relevant to the principal and resources referenced by the request.</p> <blockquote class="important"> <p>This guide includes examples that use simple entity identifiers, such as <code class="language-plaintext highlighter-rouge">jane</code> or <code class="language-plaintext highlighter-rouge">bob</code> for the name of an entity of type <code class="language-plaintext highlighter-rouge">User</code>. This is done to make the examples more readable. However, in a production system it is critical for security reasons that you use unique values that can’t be reused.</p> <p>We recommend that you use values like <a href="https://wikipedia.org/wiki/Universally_unique_identifier">universally unique identifiers (UUIDs)</a>. For example, if user <code class="language-plaintext highlighter-rouge">jane</code> leaves the company, and you later let someone else use the name <code class="language-plaintext highlighter-rouge">jane</code>, then that new user automatically gets access to everything granted by policies that still reference <code class="language-plaintext highlighter-rouge">User::"jane"</code>.</p> <p>Cedar can’t distinguish between the new user and the old. This applies to both principal and resource identifiers. Always use identifiers that are guaranteed unique and never reused to ensure that you don’t unintentionally grant access because of the presence of an old identifier in a policy.</p> <p>Where you use a UUID for an entity, we recommend that you follow it with the <code class="language-plaintext highlighter-rouge">//</code> comment specifier and the ‘friendly’ name of your entity. This helps to make your policies easier to understand. For example:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>principal == User::"a1b2c3d4-e5f6-a1b2-c3d4-EXAMPLE11111", // alice
</code></pre></div> </div> </blockquote> <h2 id="effect"> <a href="#effect" class="anchor-heading" aria-labelledby="effect"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Effect<a name="term-policy-effect"></a> </h2> <p>The effect of the policy specifies whether Cedar should <em>permit</em> or <em>forbid</em> requests that evaluate as a match for the policy. The <code class="language-plaintext highlighter-rouge">effect</code> element can have one of the following values:</p> <ul> <li><code class="language-plaintext highlighter-rouge">permit</code> – If all elements in the policy match, then the policy results in an <code class="language-plaintext highlighter-rouge">Allow</code>.</li> <li><code class="language-plaintext highlighter-rouge">forbid</code> – If all elements in the policy match, then the policy results in a <code class="language-plaintext highlighter-rouge">Deny</code>.</li> </ul> <p>After all policies in the policy store are evaluated, the results are combined as follows:</p> <ul> <li>If <em>at least one</em> matching policy results in <code class="language-plaintext highlighter-rouge">Allow</code> <strong>and</strong> there are exactly zero policies that result in <code class="language-plaintext highlighter-rouge">Deny</code>, then the overall result of the evaluation is <code class="language-plaintext highlighter-rouge">Allow</code>.</li> <li>If <em>at least one</em> matching policy results in <code class="language-plaintext highlighter-rouge">Deny</code> <strong>or</strong> if there are exactly zero policies that result in <code class="language-plaintext highlighter-rouge">Allow</code>, then the overall result of the evaluation is <code class="language-plaintext highlighter-rouge">Deny</code>.</li> </ul> <p>The following are two key principles to remember that embody the previous two rules:</p> <ul> <li>The default result, exemplified by an empty set of policies, is a <code class="language-plaintext highlighter-rouge">Deny</code> for the request, because there isn’t at least one policy that results in <code class="language-plaintext highlighter-rouge">Allow</code>. This is referred to as an <em>implicit deny</em>.</li> <li>A <code class="language-plaintext highlighter-rouge">Deny</code> result for any policy evaluation results in an overall <code class="language-plaintext highlighter-rouge">Deny</code> for the request. This is referred to as an <em>explicit deny</em>. <strong>Important</strong><br /> An explicit <code class="language-plaintext highlighter-rouge">Deny</code> for any one policy <em>**always **</em>overrides any <code class="language-plaintext highlighter-rouge">Allow</code> from other policies.</li> </ul> <h3 class="no_toc" id="effect-examples"> <a href="#effect-examples" class="anchor-heading" aria-labelledby="effect-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Effect examples<a name="term-policy-effect-examples"></a> </h3> <h4 id="permit"> <a href="#permit" class="anchor-heading" aria-labelledby="permit"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">permit</code><a name="term-policy-effect-examples-permit"></a> </h4> <p>The following <code class="language-plaintext highlighter-rouge">permit</code> example policy allows Alice to view a specific photo.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>permit(
    principal == User::"alice", 
    action == Action::"view", 
    resource == Photo::"VacationPhoto94.jpg"
);
</code></pre></div></div> <h4 id="forbid"> <a href="#forbid" class="anchor-heading" aria-labelledby="forbid"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">forbid</code><a name="term-policy-effect-examples-forbid"></a> </h4> <p>The following <code class="language-plaintext highlighter-rouge">forbid</code> example policy denies any action by any user except the resource’s <code class="language-plaintext highlighter-rouge">owner</code> on any resource that has the <code class="language-plaintext highlighter-rouge">private</code> attribute set to <code class="language-plaintext highlighter-rouge">true</code>, unless the principal making the request is the resource <code class="language-plaintext highlighter-rouge">owner</code>. This policy doesn’t explicitly allow anything; it only forbids when it matches. A resource owner making a request on a <code class="language-plaintext highlighter-rouge">private</code> resource must still have a separate policy that explicitly allows the action on the specified resource.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>forbid (
    principal,
    action,
    resource
)
when {
    resource.private
}
unless {
    principal == resource.owner
};
</code></pre></div></div> <h2 id="scope"> <a href="#scope" class="anchor-heading" aria-labelledby="scope"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Scope<a name="term-policy-scope"></a> </h2> <p>A request always includes information that Cedar uses to answer the following three questions:</p> <ul> <li><a href="#term-parc-principal">Principal</a> –Who is making the request?</li> <li><a href="#term-parc-action">Action</a> – What operation does the principal want to perform?</li> <li><a href="#term-parc-resource">Resource</a> – What does the principal want to perform the action on?</li> </ul> <p>The scope section of a Cedar policy statement defines which values <em>match</em> the request.</p> <h3 id="principal"> <a href="#principal" class="anchor-heading" aria-labelledby="principal"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">principal</code><a name="term-parc-principal"></a> </h3> <p>The <code class="language-plaintext highlighter-rouge">principal</code> element in a Cedar policy represents a role, user, service, or other identity that can make a request to perform an <code class="language-plaintext highlighter-rouge">action</code> on a <code class="language-plaintext highlighter-rouge">resource</code> in your application. If the principal making the request matches the <code class="language-plaintext highlighter-rouge">principal</code> defined in this policy statement, then this element matches.</p> <p>The <code class="language-plaintext highlighter-rouge">principal</code> element must be present. If you specify only <code class="language-plaintext highlighter-rouge">principal</code> without an expression that constrains its scope, then the policy applies to <em>any</em> principal.</p> <h4 class="no_toc" id="examples-of-the-principal-element"> <a href="#examples-of-the-principal-element" class="anchor-heading" aria-labelledby="examples-of-the-principal-element"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples of the <code class="language-plaintext highlighter-rouge">principal</code> element<a name="term-parc-principal-examples"></a> </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//matches any principal entity of any type
principal

//matches only the one specified entity of type User
principal == User::"alice"

//matches any principal in the hierarchy of the specified Group
principal in Group::"alice_friends"
</code></pre></div></div> <h3 id="action"> <a href="#action" class="anchor-heading" aria-labelledby="action"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">action</code><a name="term-parc-action"></a> </h3> <p>The <code class="language-plaintext highlighter-rouge">action</code> element in a Cedar policy is a list of the operations in your application for which this policy statement controls access. If the operation in the request matches one of the <code class="language-plaintext highlighter-rouge">action</code> items defined in this policy statement, then this element matches.</p> <h4 class="no_toc" id="examples-of-the-action-element"> <a href="#examples-of-the-action-element" class="anchor-heading" aria-labelledby="examples-of-the-action-element"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples of the <code class="language-plaintext highlighter-rouge">action</code> element<a name="term-parc-action-examples"></a> </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//matches any action
action

//matches only the one specified action
action == Action::"view"

//matches any of the listed actions
action in [Action::"listAlbums", Action::"listPhotos", Action::"view"]

//matches any action in the hierarchy of the admin entity of type PhotoFlashRole
action in PhotoFlashRole::"admin"
</code></pre></div></div> <h3 id="resource"> <a href="#resource" class="anchor-heading" aria-labelledby="resource"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">resource</code><a name="term-parc-resource"></a> </h3> <p>The resource element in a Cedar policy is a resource defined by your application that can be accessed or modified by the specified action.</p> <p>The <code class="language-plaintext highlighter-rouge">resource</code> element must be present. If you specify only <code class="language-plaintext highlighter-rouge">resource</code> without an expression that constrains its scope, then the policy applies to <em>any</em> resource.</p> <p>The <code class="language-plaintext highlighter-rouge">principal</code>, <code class="language-plaintext highlighter-rouge">action</code>, and <code class="language-plaintext highlighter-rouge">resource</code> elements are defined as entities.</p> <h4 class="no_toc" id="examples-of-the-resource-element"> <a href="#examples-of-the-resource-element" class="anchor-heading" aria-labelledby="examples-of-the-resource-element"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples of the <code class="language-plaintext highlighter-rouge">resource</code> element<a name="term-parc-resource-examples"></a> </h4> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>//matches any resource
resource

//matches only the one specified resource of type Photo
resource == Photo::"VacationPhoto94.jpg"

//matches any resource that is in the hierarchy of the specified entity of type Album
resource in Album::"alice_vacation"
</code></pre></div></div> <h2 id="conditions"> <a href="#conditions" class="anchor-heading" aria-labelledby="conditions"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Conditions<a name="term-parc-context"></a> </h2> <p>Conditions specify any additional constraints that Cedar must consider when deciding to allow or deny the request. Every <code class="language-plaintext highlighter-rouge">when</code> condition must evaluate to <code class="language-plaintext highlighter-rouge">true</code> and every <code class="language-plaintext highlighter-rouge">unless</code> condition must evaluate to <code class="language-plaintext highlighter-rouge">false</code> for the policy to match and contribute to the final decision. The conditions evaluate details that are unique to a particular access request. Consider a web service that accepts HTTP requests. The conditions for such a request might include things like the IP address from which the request originates, the HTTP headers in the request, the time of day that the request was sent, the user’s authentication posture, or detailed information about the query parameters in the HTTP request.</p> <p>Conditions can also evaluate attributes of the principals and resources specified in the query. For example, a policy could contain a condition that specifies that principals can edit any photo that has an <code class="language-plaintext highlighter-rouge">owner</code> attribute with a value that matches the ID of the principal making the request.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>permit(
    principal, 
    action == Action::"editPhoto", 
    resource
)
when {
   resource.owner == principal
};
</code></pre></div></div> <p>The scope values of <code class="language-plaintext highlighter-rouge">principal</code>, <code class="language-plaintext highlighter-rouge">action</code>, and <code class="language-plaintext highlighter-rouge">resource</code> represent stable information in the system and must be present in every request. In comparison, <code class="language-plaintext highlighter-rouge">context</code> represents information about a point-in-time request and is required only for relevant request scenarios.</p> <p>Context elements take the following two forms:</p> <ul> <li><a href="#term-parc-context-when"><code class="language-plaintext highlighter-rouge">when</code></a></li> <li><a href="#term-parc-context-unless"><code class="language-plaintext highlighter-rouge">unless</code></a></li> </ul> <h3 id="when"> <a href="#when" class="anchor-heading" aria-labelledby="when"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">when</code><a name="term-parc-context-when"></a> </h3> <p>The <code class="language-plaintext highlighter-rouge">when</code> clause causes the policy to match the request only if the embedded expression evaluates to <code class="language-plaintext highlighter-rouge">true</code>.</p> <h4 class="no_toc" id="examples-of-the-when-clause"> <a href="#examples-of-the-when-clause" class="anchor-heading" aria-labelledby="examples-of-the-when-clause"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples of the <code class="language-plaintext highlighter-rouge">when</code> clause<a name="term-parc-context-when-examples"></a> </h4> <p>The following <code class="language-plaintext highlighter-rouge">when</code> example matches the request if the principal making the request is a member of the <code class="language-plaintext highlighter-rouge">HardwareEngineering</code> department and has a <code class="language-plaintext highlighter-rouge">jobLevel</code> of at least <code class="language-plaintext highlighter-rouge">5</code>. If either attribute is missing from the principal making the request, then the policy doesn’t match.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>when {
    principal.department == "HardwareEngineering" 
    &amp;&amp;
    principal.jobLevel &gt;= 5
}
</code></pre></div></div> <p>The following <code class="language-plaintext highlighter-rouge">when</code> example matches the request if the request was submitted before the specified date and time.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>when {
  context.time.now &lt; timestamp("2022-01-01T10:15:00.021-05:00")
}
</code></pre></div></div> <h3 id="unless"> <a href="#unless" class="anchor-heading" aria-labelledby="unless"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> <code class="language-plaintext highlighter-rouge">unless</code><a name="term-parc-context-unless"></a> </h3> <p>The <code class="language-plaintext highlighter-rouge">unless</code> clause causes the policy to match the request only if the embedded expression evaluates to <code class="language-plaintext highlighter-rouge">false</code>.</p> <h4 class="no_toc" id="examples-of-the-unless-clause"> <a href="#examples-of-the-unless-clause" class="anchor-heading" aria-labelledby="examples-of-the-unless-clause"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Examples of the <code class="language-plaintext highlighter-rouge">unless</code> clause<a name="term-parc-context-unless-examples"></a> </h4> <p>The following <code class="language-plaintext highlighter-rouge">unless</code> clause does <strong><em>not</em></strong> match the request if the principal making the request is the resource’s owner.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>unless {
  principal == resource.owner
}
</code></pre></div></div> <p>The following policy example denies any request if the calling principal isn’t authenticated with multi-factor authentication (MFA). The policy assumes that <code class="language-plaintext highlighter-rouge">usedMFA</code> evaluates as a boolean to <code class="language-plaintext highlighter-rouge">true</code> or <code class="language-plaintext highlighter-rouge">false</code>.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>forbid ( principal, action, resource )
unless {
  context.authentication.usedMFA
};
</code></pre></div></div> <h2 id="annotations"> <a href="#annotations" class="anchor-heading" aria-labelledby="annotations"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Annotations<a name="term-parc-annotations"></a> </h2> <p>You can attach arbitrary string values to Cedar policies in the form of annotation. An annotation has no impact on policy evaluation. Annotations are stored as part of the policy and are available for use by services that read and process Cedar policies.</p> <p>You can place annotations only at the very top of the policy before the <a href="#term-policy-effect">effect</a> element.</p> <p>An annotation takes the form of the following string:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@annotationname("annotation value")
</code></pre></div></div> <p>The following example shows two annotations that could be part of a policy.</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@advice("My advice")
@id("My ID")
permit(
    ...
);
</code></pre></div></div> </main> <hr> <footer> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/cedar-policy/cedar-docs/tree/main/docs/syntax-policy.md" id="edit-this-page">We welcome your feedback. You can edit this page on GitHub.</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
